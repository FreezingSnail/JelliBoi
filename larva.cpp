#include "larva.h"

const uint8_t PROGMEM larvaBMP[] =
{
// width, height,
8, 8,
// TILE 00 left
0x80, 0xf0, 0x7c, 0x56, 0x6b, 0x35, 0x1d, 0x0e, 
// TILE 01 right
0x0e, 0x1d, 0x35, 0x6b, 0x56, 0x7c, 0xf0, 0x80, 
};

const uint8_t PROGMEM jelli2Larva[] =
{
// width, height,
16, 16,
// TILE 00
0x00, 0x00, 0x00, 0x00, 0xe0, 0xb0, 0xd0, 0xf0, 0xf0, 0xf0, 0xf0, 0xe0, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x5c, 0x43, 0x38, 0x87, 0x70, 0x8f, 0x60, 0x1f, 0x00, 0x00, 0x00, 0x00, 
// TILE 01
0x00, 0x00, 0x00, 0x00, 0xe0, 0xb0, 0xd0, 0xf0, 0xf0, 0xf0, 0xf0, 0xe0, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x1e, 0x21, 0x42, 0x1f, 0x02, 0x5f, 0x61, 0x1e, 0x00, 0x00, 0x00, 0x00, 
// TILE 02
0x00, 0x00, 0x00, 0x00, 0xe0, 0xb0, 0xd0, 0xf0, 0xf0, 0xf0, 0xf0, 0xe0, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x1e, 0x27, 0x23, 0x1f, 0x23, 0x1f, 0x23, 0x1e, 0x00, 0x00, 0x00, 0x00, 
// TILE 03
0x00, 0x00, 0x00, 0x00, 0xe0, 0xb0, 0xd0, 0xf0, 0xf0, 0xf0, 0xf0, 0xe0, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x0e, 0x17, 0x0b, 0x0f, 0x13, 0x1f, 0x13, 0x0e, 0x00, 0x00, 0x00, 0x00, 
// TILE 04
0x00, 0x00, 0x00, 0x00, 0xe0, 0xb0, 0xd0, 0xf0, 0xf0, 0xf0, 0xf0, 0xe0, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x06, 0x0f, 0x0b, 0x0f, 0x0b, 0x0f, 0x0b, 0x06, 0x00, 0x00, 0x00, 0x00, 
// TILE 05
0x00, 0x00, 0x00, 0x00, 0xe0, 0xb0, 0xd0, 0xf0, 0xf0, 0xf0, 0xf0, 0xe0, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x03, 0x07, 0x05, 0x07, 0x05, 0x07, 0x05, 0x03, 0x00, 0x00, 0x00, 0x00, 
// TILE 06
0x00, 0x00, 0x00, 0x00, 0xc0, 0xe0, 0xa0, 0xe0, 0xe0, 0xe0, 0xe0, 0xc0, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x01, 0x03, 0x02, 0x03, 0x02, 0x03, 0x02, 0x01, 0x00, 0x00, 0x00, 0x00, 
// TILE 07
0x00, 0x00, 0x00, 0x00, 0x00, 0xc0, 0xe0, 0xa0, 0xe0, 0xe0, 0xc0, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x03, 0x02, 0x03, 0x02, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 
// TILE 08
0x00, 0x00, 0x00, 0x00, 0x00, 0xc0, 0xe0, 0xa0, 0xe0, 0xe0, 0xc0, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x03, 0x02, 0x03, 0x02, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 
// TILE 09
0x00, 0x00, 0x00, 0x00, 0x00, 0xc0, 0xe0, 0xa0, 0xf0, 0xf0, 0xd0, 0xe0, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x03, 0x07, 0x07, 0x02, 0x03, 0x02, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 
// TILE 10
0x00, 0x00, 0x00, 0x00, 0x00, 0xc0, 0xe0, 0xa0, 0xf0, 0xf0, 0xd0, 0xe0, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x08, 0x07, 0x07, 0x06, 0x07, 0x02, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 
// TILE 11
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xc0, 0xa0, 0xf0, 0xf0, 0xd0, 0xe0, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x08, 0x07, 0x07, 0x06, 0x07, 0x02, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 
// TILE 12
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xc0, 0x60, 0xb0, 0x50, 0xd0, 0xe0, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x08, 0x0f, 0x07, 0x05, 0x06, 0x03, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 
};

larva::larva(int xStart, int yStart){
  x = xStart;
  y = yStart;
  spriteDirection = 1;
  horizontalSpeed = 0;
  growCounter = 0;
}

void larva::setDirection(){
  if (playerDirection == left){
    spriteDirection = 0;
    horizontalSpeed = -1;
  }
  else  if (playerDirection == right){
    spriteDirection = 1;
    horizontalSpeed = 1;
  }
}

void larva::drawLarva(){
  if(CycleCount>1 && counter <=24){
    sprite.drawSelfMasked(x-4, y-4, jelli2Larva, counter/2);
  }
  else{sprite.drawSelfMasked(x, y, larvaBMP, spriteDirection);}
}

void larva::updateLarva(){
  setDirection();
  if(counter >24){
  if( y < 64-8){
  x += horizontalSpeed;
  if(frameCounter % 4 == 0){
   y += downSpeed;
  }
 
    if(x < 0){ 
      horizontalSpeed = 1; 
      spriteDirection = 1;
      }
    if(x > 120){ 
      horizontalSpeed = -1; 
      spriteDirection = 0;
      }
      if(x > 120){
    x = 120;
  }
  else if( x < 0 ){
    x = 0; 
  }
  }
   else {
    growCounter++;
  }
    if (growCounter > 30){
    frameCounter = 0;
    enteringStage = true;
    GameStage = Polyp;
   
  }
  }
  else{counter++;}
  
}



